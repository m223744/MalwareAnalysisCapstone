# AUTOMATED STATIC ANALYSIS OF BINARIES AND RANSOMWARE 

## Students
	Dylan Larkin, m223744, m223744@usna.edu
	Greg Nelson, m224788, m224788@usna.edu
	Eric Tymoshenko, m226678, m226678@usna.edu

## Faculty Mentors
	LCDR Andrew Slack, slack@usna.edu
	Dr. Dane Brown, dabrown@usna.edu

## Supplies
* Raspberry Pi 4b 4GB used as a web server to host our automated scripts and maintain a database of collected binaries.
* Linux VM-Machine used as a sandbox for download and analysis of malicious executables. 

## Timeline  
* Started 12OCT20
	* Began compiling resources, acquired our faculty mentors, and established our "draft goal" of what we seek to accomplish.
* 12OCT20 - 12APR21
	* Reviewed references, revised end-goal and project, and began discussing approach.
* 01SEP21
	* Began revision of project goals and meeting with team mentors. 

* 01OCT21 - 01JAN22
	* Began development of toolkit, learning about machine learning models, and studying possible features of interest for specific binaries. 

* 02JAN22 - 01MAR22
 	* After multiple failures and being stuck in the same place, we decided to focus primarily on PE files, specifically .exe and .dll binaries. This decision allowed us to standardize our data extracted and dataset creation for the machine learning algorithm. 

* 01MAR22 - 01APR22
	* Significant progress was made with the development of the website and toolkit. A Gradient Boosting classifier was determined to be the best model for a multi-label classification. We found large enough datasets to support the classification of the following types of malware: 
		* Ransomware
		* Trojans
		* Adware  



![image](https://user-images.githubusercontent.com/60119034/134088517-a601a97b-967e-4943-b3db-85f5b3671971.png)
:--:
*Pre Launch Timeline* 

![image](https://user-images.githubusercontent.com/60119034/134088594-71954cf4-0cfd-409d-b028-a33561d9baf9.png)
:--:
*Code Development Timeline* 

# Scope of the Capstone

### Our Focus
![image](https://user-images.githubusercontent.com/60119034/161289882-189f3d09-5925-42b2-8b8c-9af35bca651c.png)

This capstone will primarily focus on .exe and .dll executables that are found on Windows Operating Systems. We will attempt to build a toolkit that is able to distinguish whether or not a file is malicious and categorize it as a ransomware, trojan, or adware malware executable. 

### Individual Responsibilities
* Dylan: 
	* Focused on utilizing native Linux commands in order to analyze and parse data that is useful for Binary static analyis. 
	* Used imported python modules to extract file information to be used as features in the machine learning model. 
	* Created the machine learning model using a Gradient Boosting multi-label classifier in order to categorize binaries as non-malicious, ransomware, trojans, or adware.

* Eric: 
	* Focused on implementing the usage of imported python modules from tools such as Ghidra, and incorporating API's from websites such as VirusTotal in order to cross-check our work. 
	* Researched and retrieved PE files from online databases to be used for data extraction and creation of the model's dataset. 

* Greg:
	* Built the backend Flask website that will support a database of the Binary files that we have analyzed with our toolkit. The website provides an overview of the Binary through a text file, as well as other identifying information such as the md5, sha1, sha256 hashes, and finally labels the binary as non-malware, ransomware, trojan, or adware. 
	* Was a primary contributor to the creation of the IEEE paper that we've written for the capstone project.  


### What Are Other Projects?
We want to see what other static Binary analysis projects have been published recently, and see if there is anything different that we can do. We may use recent projects as a guide, but intend to write the program from scratch. 

### End-Goal
Provide an automated static Binary and ransomware analysis toolkit using **_OPEN-SOURCE_** software and python libraries that will analyize important characteristics of the file and categorize them based off of their static properties to determine whether or not they are malicious. This tool will be used via website hosted on the Raspberry Pi 4 and store analysis results in a MySQL database for later analysis and categorization, but will also be able to be used via command line for quick static analysis with no database storage.


# How to use
### Command Line Interface
The command line interface should be used in the following way in the MalwareAnalysisCapstone/mainCode folder:
	** python toolkit.py -i[--infile] <relative or absolute path of binary> -o[--outfile] <name of the file you want the analysis written to in .txt format> 

The program will print to the terminal the suspected classification of the binary, in addition to the probabilities that our model discovered for each classification label, such as the following image. 
	
![image](https://user-images.githubusercontent.com/60119034/161282204-72b26b10-5f09-4771-9349-283f405e46b3.png)
	
### Website Based Interface 
The website based interface is hosted on a Flask-based backend. Navigate to /MalwareAnalysisCapstone/FlaskWebsite/virtual, and run the following command:
	** python app.py 
A website will be populated on your localhost:5000. Navigate to the [Submit] tab at the top of the webpage. Here, you can select a binary to analyze. _ONLY .EXE AND .DLL FILES ARE WORKING AS INTENDED. ANY OTHER FILE INPUT WILL LIKELY CRASH THE PROGRAM._

Upon submission of a file, you can click on the [Files] tab at the top to view all binaries you've inserted into the database, as well as download a local .txt file containing information about the static properties of the file itself.
	
![image](https://user-images.githubusercontent.com/60119034/161287071-98b92223-804f-40a9-a73c-b1af082e99e4.png)
	
All analyzed files are placed in /MalwareAnalysisCapstone/analyzedFiles/

	



