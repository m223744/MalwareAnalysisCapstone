#!/usr/bin/python3

import sys, os, subprocess

def main(functionType):
    if functionType == "DECOMPILE":
        print("Running Decompiler!")
        ghidraDir = input("Enter the location of your ghidra directory: ").strip("' ")
        binaryLocation = input("Enter the path to the binary: ").strip("' ")
        cExtractorLocation = input("Enter path to C extraction script: ").strip("' ")
        outputPath = input("Enter path to function output: ")

        subprocess.run(["./callGhidra.sh", binaryLocation, ghidraDir, cExtractorLocation, outputPath])

        return

    if functionType == "ANALYZE":
        print("Analyzer")
        cFileLocation = input("Enter the location of the decompiled code: ")

        with open(cFileLocation, "r") as cFile:
            code = cFile.read()
            if "AES" in code:
                print("Encryption/Decryption Detected! This program makes calls cryptographic functions.")
        return








if __name__ == "__main__":
    option = input("DECOMPILE or ANALYZE: ")
    if option == "DECOMPILE" or option == "ANALYZE":
        main(option)
