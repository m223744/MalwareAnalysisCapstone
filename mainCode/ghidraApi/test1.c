// DECOMPILED FROM GHIDRA
// Functions: 
////_init
////FUN_001006f0
////strncpy
////strncmp
////puts
////write
////strlen
////__stack_chk_fail
////read
////open
////getopt
////__cxa_finalize
////_start
////deregister_tm_clones
////register_tm_clones
////__do_global_dtors_aux
////frame_dummy
////KeyExpansion
////AES_init_ctx
////AES_init_ctx_iv
////AES_ctx_set_iv
////AddRoundKey
////SubBytes
////ShiftRows
////xtime
////MixColumns
////InvMixColumns
////InvSubBytes
////InvShiftRows
////Cipher
////InvCipher
////AES_ECB_encrypt
////AES_ECB_decrypt
////XorWithIv
////AES_CBC_encrypt_buffer
////AES_CBC_decrypt_buffer
////AES_CTR_xcrypt_buffer
////HASHReset
////HASHResult
////HASHInput
////HASHProcessMessageBlock
////HASHPadMessage
////main
////__libc_csu_init
////__libc_csu_fini
////_fini
////strncpy
////strncmp
////_ITM_deregisterTMCloneTable
////puts
////write
////strlen
////__stack_chk_fail
////read
////__libc_start_main
////__gmon_start__
////open
////getopt
////_ITM_registerTMCloneTable
////__cxa_finalize


// C Code: 

int _init(EVP_PKEY_CTX *ctx)

{
  undefined *puVar1;
  
  puVar1 = PTR___gmon_start___00303fe8;
  if (PTR___gmon_start___00303fe8 != (undefined *)0x0) {
    puVar1 = (undefined *)(*(code *)PTR___gmon_start___00303fe8)();
  }
  return (int)puVar1;
}


void FUN_001006f0(void)

{
                    /* WARNING: Treating indirect jump as call */
  (*(code *)PTR_00303f88)();
  return;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

char * strncpy(char *__dest,char *__src,size_t __n)

{
  char *pcVar1;
  
  pcVar1 = (char *)(*(code *)PTR_strncpy_00303f90)();
  return pcVar1;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

int strncmp(char *__s1,char *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = (*(code *)PTR_strncmp_00303f98)();
  return iVar1;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

int puts(char *__s)

{
  int iVar1;
  
  iVar1 = (*(code *)PTR_puts_00303fa0)();
  return iVar1;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

ssize_t write(int __fd,void *__buf,size_t __n)

{
  ssize_t sVar1;
  
  sVar1 = (*(code *)PTR_write_00303fa8)();
  return sVar1;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

size_t strlen(char *__s)

{
  size_t sVar1;
  
  sVar1 = (*(code *)PTR_strlen_00303fb0)();
  return sVar1;
}


void __stack_chk_fail(void)

{
  (*(code *)PTR___stack_chk_fail_00303fb8)();
  return;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

ssize_t read(int __fd,void *__buf,size_t __nbytes)

{
  ssize_t sVar1;
  
  sVar1 = (*(code *)PTR_read_00303fc0)();
  return sVar1;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

int open(char *__file,int __oflag,...)

{
  int iVar1;
  
  iVar1 = (*(code *)PTR_open_00303fc8)();
  return iVar1;
}


/* WARNING: Unknown calling convention yet parameter storage is locked */

int getopt(int ___argc,char **___argv,char *__shortopts)

{
  int iVar1;
  
  iVar1 = (*(code *)PTR_getopt_00303fd0)();
  return iVar1;
}


void __cxa_finalize(void)

{
  (*(code *)PTR___cxa_finalize_00303ff8)();
  return;
}


void _start(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  undefined8 in_stack_00000000;
  undefined auStack8 [8];
  
  (*(code *)PTR___libc_start_main_00303fe0)
            (main,in_stack_00000000,&stack0x00000008,__libc_csu_init,__libc_csu_fini,param_3,
             auStack8);
  do {
                    /* WARNING: Do nothing block with infinite loop */
  } while( true );
}


/* WARNING: Removing unreachable block (ram,0x001007e7) */
/* WARNING: Removing unreachable block (ram,0x001007f3) */

void deregister_tm_clones(void)

{
  return;
}


/* WARNING: Removing unreachable block (ram,0x00100838) */
/* WARNING: Removing unreachable block (ram,0x00100844) */

void register_tm_clones(void)

{
  return;
}


void __do_global_dtors_aux(void)

{
  if (completed_7698 == '\0') {
    if (PTR___cxa_finalize_00303ff8 != (undefined *)0x0) {
      __cxa_finalize(__dso_handle);
    }
    deregister_tm_clones();
    completed_7698 = 1;
    return;
  }
  return;
}


void frame_dummy(void)

{
  register_tm_clones();
  return;
}


void KeyExpansion(long param_1,long param_2)

{
  long lVar1;
  uint uVar2;
  uint uVar3;
  long in_FS_OFFSET;
  uint local_20;
  byte local_14;
  byte local_13;
  byte local_12;
  byte local_11;
  
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  local_20 = 0;
  while (local_20 < 4) {
    *(undefined *)(param_1 + (ulong)(local_20 << 2)) =
         *(undefined *)(param_2 + (ulong)(local_20 << 2));
    *(undefined *)(param_1 + (ulong)(local_20 * 4 + 1)) =
         *(undefined *)(param_2 + (ulong)(local_20 * 4 + 1));
    *(undefined *)(param_1 + (ulong)(local_20 * 4 + 2)) =
         *(undefined *)(param_2 + (ulong)(local_20 * 4 + 2));
    *(undefined *)(param_1 + (ulong)(local_20 * 4 + 3)) =
         *(undefined *)(param_2 + (ulong)(local_20 * 4 + 3));
    local_20 = local_20 + 1;
  }
  local_20 = 4;
  while (local_20 < 0x2c) {
    uVar2 = (local_20 + 0x3fffffff) * 4;
    local_14 = *(byte *)(param_1 + (ulong)uVar2);
    local_13 = *(byte *)(param_1 + (ulong)(uVar2 + 1));
    local_12 = *(byte *)(param_1 + (ulong)(uVar2 + 2));
    local_11 = *(byte *)(param_1 + (ulong)(uVar2 + 3));
    if ((local_20 & 3) == 0) {
      uVar2 = (uint)local_13;
      local_13 = sbox[(int)(uint)local_12];
      local_12 = sbox[(int)(uint)local_11];
      local_11 = sbox[(int)(uint)local_14];
      local_14 = Rcon[local_20 >> 2] ^ sbox[(int)uVar2];
    }
    uVar2 = local_20 * 4;
    uVar3 = (local_20 + 0x3ffffffc) * 4;
    *(byte *)(param_1 + (ulong)uVar2) = *(byte *)(param_1 + (ulong)uVar3) ^ local_14;
    *(byte *)(param_1 + (ulong)(uVar2 + 1)) = local_13 ^ *(byte *)(param_1 + (ulong)(uVar3 + 1));
    *(byte *)(param_1 + (ulong)(uVar2 + 2)) = local_12 ^ *(byte *)(param_1 + (ulong)(uVar3 + 2));
    *(byte *)(param_1 + (ulong)(uVar2 + 3)) = local_11 ^ *(byte *)(param_1 + (ulong)(uVar3 + 3));
    local_20 = local_20 + 1;
  }
  if (lVar1 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return;
}


void AES_init_ctx(undefined8 param_1,undefined8 param_2)

{
  KeyExpansion(param_1,param_2,param_2);
  return;
}


void AES_init_ctx_iv(long param_1,undefined8 param_2,undefined8 *param_3)

{
  undefined8 uVar1;
  
  KeyExpansion(param_1,param_2,param_2);
  uVar1 = param_3[1];
  *(undefined8 *)(param_1 + 0xb0) = *param_3;
  *(undefined8 *)(param_1 + 0xb8) = uVar1;
  return;
}


void AES_ctx_set_iv(long param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  
  uVar1 = param_2[1];
  *(undefined8 *)(param_1 + 0xb0) = *param_2;
  *(undefined8 *)(param_1 + 0xb8) = uVar1;
  return;
}


void AddRoundKey(byte param_1,long param_2,long param_3)

{
  byte local_a;
  byte local_9;
  
  local_a = 0;
  while (local_a < 4) {
    local_9 = 0;
    while (local_9 < 4) {
      *(byte *)((long)(int)(uint)local_a * 4 + param_2 + (long)(int)(uint)local_9) =
           *(byte *)((long)(int)(uint)local_a * 4 + param_2 + (long)(int)(uint)local_9) ^
           *(byte *)(param_3 + (int)((uint)local_9 + ((uint)local_a + (uint)param_1 * 4) * 4));
      local_9 = local_9 + 1;
    }
    local_a = local_a + 1;
  }
  return;
}


void SubBytes(long param_1)

{
  byte local_a;
  byte local_9;
  
  local_a = 0;
  while (local_a < 4) {
    local_9 = 0;
    while (local_9 < 4) {
      *(undefined1 *)((long)(int)(uint)local_9 * 4 + param_1 + (long)(int)(uint)local_a) =
           sbox[(int)(uint)*(byte *)((long)(int)(uint)local_9 * 4 + param_1 +
                                    (long)(int)(uint)local_a)];
      local_9 = local_9 + 1;
    }
    local_a = local_a + 1;
  }
  return;
}


void ShiftRows(long param_1)

{
  undefined uVar1;
  
  uVar1 = *(undefined *)(param_1 + 1);
  *(undefined *)(param_1 + 1) = *(undefined *)(param_1 + 5);
  *(undefined *)(param_1 + 5) = *(undefined *)(param_1 + 9);
  *(undefined *)(param_1 + 9) = *(undefined *)(param_1 + 0xd);
  *(undefined *)(param_1 + 0xd) = uVar1;
  uVar1 = *(undefined *)(param_1 + 2);
  *(undefined *)(param_1 + 2) = *(undefined *)(param_1 + 10);
  *(undefined *)(param_1 + 10) = uVar1;
  uVar1 = *(undefined *)(param_1 + 6);
  *(undefined *)(param_1 + 6) = *(undefined *)(param_1 + 0xe);
  *(undefined *)(param_1 + 0xe) = uVar1;
  uVar1 = *(undefined *)(param_1 + 3);
  *(undefined *)(param_1 + 3) = *(undefined *)(param_1 + 0xf);
  *(undefined *)(param_1 + 0xf) = *(undefined *)(param_1 + 0xb);
  *(undefined *)(param_1 + 0xb) = *(undefined *)(param_1 + 7);
  *(undefined *)(param_1 + 7) = uVar1;
  return;
}


uint xtime(byte param_1)

{
  return (uint)(param_1 >> 7) * 0x1b ^ (uint)param_1 * 2;
}


void MixColumns(long param_1)

{
  byte bVar1;
  byte bVar2;
  byte local_c;
  
  local_c = 0;
  while (local_c < 4) {
    bVar1 = *(byte *)(param_1 + 3 + (long)(int)(uint)local_c * 4) ^
            *(byte *)(param_1 + (long)(int)(uint)local_c * 4) ^
            *(byte *)(param_1 + 1 + (long)(int)(uint)local_c * 4) ^
            *(byte *)(param_1 + 2 + (long)(int)(uint)local_c * 4);
    bVar2 = xtime(*(byte *)(param_1 + 1 + (long)(int)(uint)local_c * 4) ^
                  *(byte *)(param_1 + (long)(int)(uint)local_c * 4));
    *(byte *)(param_1 + (long)(int)(uint)local_c * 4) =
         *(byte *)(param_1 + (long)(int)(uint)local_c * 4) ^ bVar2 ^ bVar1;
    bVar2 = xtime();
    *(byte *)(param_1 + 1 + (long)(int)(uint)local_c * 4) =
         *(byte *)(param_1 + 1 + (long)(int)(uint)local_c * 4) ^ bVar2 ^ bVar1;
    bVar2 = xtime();
    *(byte *)(param_1 + 2 + (long)(int)(uint)local_c * 4) =
         *(byte *)(param_1 + 2 + (long)(int)(uint)local_c * 4) ^ bVar2 ^ bVar1;
    bVar2 = xtime();
    *(byte *)(param_1 + 3 + (long)(int)(uint)local_c * 4) =
         *(byte *)(param_1 + 3 + (long)(int)(uint)local_c * 4) ^ bVar2 ^ bVar1;
    local_c = local_c + 1;
  }
  return;
}


void InvMixColumns(long param_1)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  byte bVar6;
  byte bVar7;
  byte bVar8;
  byte bVar9;
  byte bVar10;
  byte bVar11;
  byte bVar12;
  int local_1c;
  
  local_1c = 0;
  while (local_1c < 4) {
    bVar1 = *(byte *)(param_1 + (long)local_1c * 4);
    bVar2 = *(byte *)(param_1 + 1 + (long)local_1c * 4);
    bVar3 = *(byte *)(param_1 + 2 + (long)local_1c * 4);
    bVar12 = *(byte *)(param_1 + 3 + (long)local_1c * 4);
    xtime(bVar1);
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    bVar4 = xtime();
    xtime();
    bVar5 = xtime();
    xtime();
    xtime();
    bVar6 = xtime();
    bVar7 = xtime();
    xtime();
    xtime();
    bVar8 = xtime();
    xtime();
    bVar9 = xtime();
    xtime();
    xtime();
    bVar10 = xtime();
    xtime();
    xtime();
    bVar11 = xtime();
    *(byte *)(param_1 + (long)local_1c * 4) =
         bVar4 ^ bVar5 ^ bVar6 ^ bVar8 ^ bVar7 ^ bVar2 ^ bVar10 ^ bVar9 ^ bVar3 ^ bVar11 ^ bVar12;
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    bVar4 = xtime();
    bVar5 = xtime();
    xtime();
    bVar6 = xtime();
    xtime();
    xtime();
    bVar7 = xtime();
    bVar8 = xtime();
    xtime();
    xtime();
    bVar9 = xtime();
    xtime();
    bVar10 = xtime();
    xtime();
    xtime();
    bVar11 = xtime();
    *(byte *)(param_1 + 1 + (long)local_1c * 4) =
         bVar4 ^ bVar1 ^ bVar7 ^ bVar5 ^ bVar6 ^ bVar9 ^ bVar8 ^ bVar3 ^ bVar11 ^ bVar10 ^ bVar12;
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    bVar4 = xtime();
    xtime();
    xtime();
    bVar5 = xtime();
    xtime();
    xtime();
    bVar6 = xtime();
    bVar7 = xtime();
    xtime();
    bVar8 = xtime();
    xtime();
    xtime();
    bVar9 = xtime();
    bVar10 = xtime();
    xtime();
    xtime();
    bVar11 = xtime();
    *(byte *)(param_1 + 2 + (long)local_1c * 4) =
         bVar4 ^ bVar1 ^ bVar5 ^ bVar6 ^ bVar2 ^ bVar9 ^ bVar7 ^ bVar8 ^ bVar11 ^ bVar10 ^ bVar12;
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    xtime();
    bVar12 = xtime();
    xtime();
    xtime();
    bVar4 = xtime();
    xtime();
    bVar5 = xtime();
    xtime();
    xtime();
    bVar6 = xtime();
    xtime();
    xtime();
    bVar7 = xtime();
    bVar8 = xtime();
    xtime();
    bVar9 = xtime();
    xtime();
    xtime();
    bVar10 = xtime();
    *(byte *)(param_1 + 3 + (long)local_1c * 4) =
         bVar12 ^ bVar1 ^ bVar4 ^ bVar6 ^ bVar5 ^ bVar2 ^ bVar7 ^ bVar3 ^ bVar10 ^ bVar8 ^ bVar9;
    local_1c = local_1c + 1;
  }
  return;
}


void InvSubBytes(long param_1)

{
  byte local_a;
  byte local_9;
  
  local_a = 0;
  while (local_a < 4) {
    local_9 = 0;
    while (local_9 < 4) {
      *(undefined1 *)((long)(int)(uint)local_9 * 4 + param_1 + (long)(int)(uint)local_a) =
           rsbox[(int)(uint)*(byte *)((long)(int)(uint)local_9 * 4 + param_1 +
                                     (long)(int)(uint)local_a)];
      local_9 = local_9 + 1;
    }
    local_a = local_a + 1;
  }
  return;
}


void InvShiftRows(long param_1)

{
  undefined uVar1;
  
  uVar1 = *(undefined *)(param_1 + 0xd);
  *(undefined *)(param_1 + 0xd) = *(undefined *)(param_1 + 9);
  *(undefined *)(param_1 + 9) = *(undefined *)(param_1 + 5);
  *(undefined *)(param_1 + 5) = *(undefined *)(param_1 + 1);
  *(undefined *)(param_1 + 1) = uVar1;
  uVar1 = *(undefined *)(param_1 + 2);
  *(undefined *)(param_1 + 2) = *(undefined *)(param_1 + 10);
  *(undefined *)(param_1 + 10) = uVar1;
  uVar1 = *(undefined *)(param_1 + 6);
  *(undefined *)(param_1 + 6) = *(undefined *)(param_1 + 0xe);
  *(undefined *)(param_1 + 0xe) = uVar1;
  uVar1 = *(undefined *)(param_1 + 3);
  *(undefined *)(param_1 + 3) = *(undefined *)(param_1 + 7);
  *(undefined *)(param_1 + 7) = *(undefined *)(param_1 + 0xb);
  *(undefined *)(param_1 + 0xb) = *(undefined *)(param_1 + 0xf);
  *(undefined *)(param_1 + 0xf) = uVar1;
  return;
}


void Cipher(undefined8 param_1,undefined8 param_2)

{
  char local_9;
  
  AddRoundKey(0,param_1,param_2);
  local_9 = '\x01';
  while( true ) {
    SubBytes(param_1);
    ShiftRows(param_1);
    if (local_9 == '\n') break;
    MixColumns(param_1);
    AddRoundKey(local_9,param_1,param_2,param_1);
    local_9 = local_9 + '\x01';
  }
  AddRoundKey(10,param_1,param_2);
  return;
}


void InvCipher(undefined8 param_1,undefined8 param_2)

{
  char local_9;
  
  AddRoundKey(10,param_1,param_2);
  local_9 = '\t';
  while( true ) {
    InvShiftRows(param_1);
    InvSubBytes(param_1);
    AddRoundKey(local_9,param_1,param_2,param_1);
    if (local_9 == '\0') break;
    InvMixColumns(param_1);
    local_9 = local_9 + -1;
  }
  return;
}


void AES_ECB_encrypt(undefined8 param_1,undefined8 param_2)

{
  Cipher(param_2,param_1,param_1);
  return;
}


void AES_ECB_decrypt(undefined8 param_1,undefined8 param_2)

{
  InvCipher(param_2,param_1,param_1);
  return;
}


void XorWithIv(long param_1,long param_2)

{
  byte local_9;
  
  local_9 = 0;
  while (local_9 < 0x10) {
    *(byte *)(param_1 + (ulong)local_9) =
         *(byte *)(param_1 + (ulong)local_9) ^ *(byte *)(param_2 + (ulong)local_9);
    local_9 = local_9 + 1;
  }
  return;
}


void AES_CBC_encrypt_buffer(long param_1,undefined8 *param_2,ulong param_3)

{
  undefined8 uVar1;
  undefined8 *local_28;
  ulong local_18;
  undefined8 *local_10;
  
  local_10 = (undefined8 *)(param_1 + 0xb0);
  local_18 = 0;
  local_28 = param_2;
  while (local_18 < param_3) {
    XorWithIv(local_28,local_10,local_10);
    Cipher(local_28,param_1,param_1);
    local_10 = local_28;
    local_28 = local_28 + 2;
    local_18 = local_18 + 0x10;
  }
  uVar1 = local_10[1];
  *(undefined8 *)(param_1 + 0xb0) = *local_10;
  *(undefined8 *)(param_1 + 0xb8) = uVar1;
  return;
}


void AES_CBC_decrypt_buffer(long param_1,undefined8 *param_2,ulong param_3)

{
  long lVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  long in_FS_OFFSET;
  undefined8 *local_48;
  ulong local_30;
  
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  local_30 = 0;
  local_48 = param_2;
  while (local_30 < param_3) {
    uVar2 = local_48[1];
    uVar3 = *local_48;
    InvCipher(local_48,param_1,param_1);
    XorWithIv(local_48,param_1 + 0xb0,param_1 + 0xb0);
    *(undefined8 *)(param_1 + 0xb0) = uVar3;
    *(undefined8 *)(param_1 + 0xb8) = uVar2;
    local_48 = local_48 + 2;
    local_30 = local_30 + 0x10;
  }
  if (lVar1 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return;
}


void AES_CTR_xcrypt_buffer(long param_1,long param_2,ulong param_3)

{
  long in_FS_OFFSET;
  int local_34;
  ulong local_30;
  undefined8 local_28;
  undefined8 local_20;
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  local_30 = 0;
  local_34 = 0x10;
  do {
    if (param_3 <= local_30) {
      if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
        __stack_chk_fail();
      }
      return;
    }
    if (local_34 == 0x10) {
      local_20 = *(undefined8 *)(param_1 + 0xb8);
      local_28 = *(undefined8 *)(param_1 + 0xb0);
      Cipher(&local_28);
      local_34 = 0xf;
      while (-1 < local_34) {
        if (*(char *)(param_1 + 0xb0 + (long)local_34) != -1) {
          *(char *)(param_1 + 0xb0 + (long)local_34) =
               *(char *)(param_1 + 0xb0 + (long)local_34) + '\x01';
          break;
        }
        *(undefined *)(param_1 + 0xb0 + (long)local_34) = 0;
        local_34 = local_34 + -1;
      }
      local_34 = 0;
    }
    *(byte *)(local_30 + param_2) =
         *(byte *)(local_30 + param_2) ^ *(byte *)((long)&local_28 + (long)local_34);
    local_30 = local_30 + 1;
    local_34 = local_34 + 1;
  } while( true );
}


bool HASHReset(undefined4 *param_1)

{
  if (param_1 != (undefined4 *)0x0) {
    param_1[5] = 0;
    param_1[6] = 0;
    *(undefined2 *)(param_1 + 7) = 0;
    *param_1 = 0x67452301;
    param_1[1] = 0xefcdab89;
    param_1[2] = 0x98badcfe;
    param_1[3] = 0x10325476;
    param_1[4] = 0xc3d2e1f0;
    param_1[0x18] = 0;
    param_1[0x19] = 0;
  }
  return param_1 == (undefined4 *)0x0;
}


undefined4 HASHResult(long param_1,long param_2)

{
  undefined4 uVar1;
  uint local_c;
  
  if ((param_1 == 0) || (param_2 == 0)) {
    uVar1 = 1;
  }
  else {
    if (*(int *)(param_1 + 100) == 0) {
      if (*(int *)(param_1 + 0x60) == 0) {
        HASHPadMessage(param_1);
        local_c = 0;
        while ((int)local_c < 0x40) {
          *(undefined *)(param_1 + 0x1e + (long)(int)local_c) = 0;
          local_c = local_c + 1;
        }
        *(undefined4 *)(param_1 + 0x14) = 0;
        *(undefined4 *)(param_1 + 0x18) = 0;
        *(undefined4 *)(param_1 + 0x60) = 1;
      }
      local_c = 0;
      while ((int)local_c < 0x14) {
        *(char *)(param_2 + (int)local_c) =
             (char)(*(uint *)(param_1 + (long)((int)local_c >> 2) * 4) >>
                   (sbyte)((~local_c & 3) << 3));
        local_c = local_c + 1;
      }
      uVar1 = 0;
    }
    else {
      uVar1 = *(undefined4 *)(param_1 + 100);
    }
  }
  return uVar1;
}


undefined4 HASHInput(long param_1,undefined *param_2,int param_3)

{
  short sVar1;
  undefined4 uVar2;
  int local_1c;
  undefined *local_18;
  
  if (param_3 == 0) {
    uVar2 = 0;
  }
  else {
    if ((param_1 == 0) || (param_2 == (undefined *)0x0)) {
      uVar2 = 1;
    }
    else {
      if (*(int *)(param_1 + 0x60) == 0) {
        local_1c = param_3;
        local_18 = param_2;
        if (*(int *)(param_1 + 100) == 0) {
          while ((local_1c != 0 && (*(int *)(param_1 + 100) == 0))) {
            sVar1 = *(short *)(param_1 + 0x1c);
            *(short *)(param_1 + 0x1c) = sVar1 + 1;
            *(undefined *)(param_1 + 0x1e + (long)(int)sVar1) = *local_18;
            *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 8;
            if (*(int *)(param_1 + 0x14) == 0) {
              *(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + 1;
              if (*(int *)(param_1 + 0x18) == 0) {
                *(undefined4 *)(param_1 + 100) = 1;
              }
            }
            if (*(short *)(param_1 + 0x1c) == 0x40) {
              HASHProcessMessageBlock(param_1);
            }
            local_18 = local_18 + 1;
            local_1c = local_1c + -1;
          }
          uVar2 = 0;
        }
        else {
          uVar2 = *(undefined4 *)(param_1 + 100);
        }
      }
      else {
        *(undefined4 *)(param_1 + 100) = 3;
        uVar2 = 3;
      }
    }
  }
  return uVar2;
}


void HASHProcessMessageBlock(uint *param_1)

{
  uint uVar1;
  long lVar2;
  int iVar3;
  long in_FS_OFFSET;
  int local_174;
  uint local_170;
  uint local_16c;
  uint local_168;
  uint local_164;
  uint local_160;
  uint auStack344 [82];
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  local_174 = 0;
  while (local_174 < 0x10) {
    auStack344[local_174] = (uint)*(byte *)((long)param_1 + (long)(local_174 << 2) + 0x1e) << 0x18;
    auStack344[local_174] =
         auStack344[local_174] |
         (uint)*(byte *)((long)param_1 + (long)(local_174 * 4 + 1) + 0x1e) << 0x10;
    auStack344[local_174] =
         auStack344[local_174] |
         (uint)*(byte *)((long)param_1 + (long)(local_174 * 4 + 2) + 0x1e) << 8;
    auStack344[local_174] =
         auStack344[local_174] | (uint)*(byte *)((long)param_1 + (long)(local_174 * 4 + 3) + 0x1e);
    local_174 = local_174 + 1;
  }
  local_174 = 0x10;
  while (local_174 < 0x50) {
    uVar1 = auStack344[local_174 + -0x10] ^
            auStack344[local_174 + -3] ^ auStack344[local_174 + -8] ^ auStack344[local_174 + -0xe];
    auStack344[local_174] = uVar1 << 1 | (uint)((int)uVar1 < 0);
    local_174 = local_174 + 1;
  }
  local_16c = param_1[1];
  local_168 = param_1[2];
  local_164 = param_1[3];
  local_160 = param_1[4];
  local_174 = 0;
  local_170 = *param_1;
  while (local_174 < 0x14) {
    iVar3 = (local_170 << 5 | local_170 >> 0x1b) + (~local_16c & local_164 | local_16c & local_168)
            + local_160;
    lVar2 = (long)local_174;
    local_160 = local_164;
    local_164 = local_168;
    local_168 = local_16c >> 2 | local_16c << 0x1e;
    local_16c = local_170;
    local_174 = local_174 + 1;
    local_170 = K_1928._0_4_ + iVar3 + auStack344[lVar2];
  }
  local_174 = 0x14;
  while (local_174 < 0x28) {
    iVar3 = (local_170 << 5 | local_170 >> 0x1b) + (local_16c ^ local_168 ^ local_164) + local_160;
    lVar2 = (long)local_174;
    local_160 = local_164;
    local_164 = local_168;
    local_168 = local_16c >> 2 | local_16c << 0x1e;
    local_16c = local_170;
    local_174 = local_174 + 1;
    local_170 = K_1928._4_4_ + iVar3 + auStack344[lVar2];
  }
  local_174 = 0x28;
  while (local_174 < 0x3c) {
    iVar3 = (local_170 << 5 | local_170 >> 0x1b) +
            (local_168 & local_164 | (local_168 | local_164) & local_16c) + local_160;
    lVar2 = (long)local_174;
    local_160 = local_164;
    local_164 = local_168;
    local_168 = local_16c >> 2 | local_16c << 0x1e;
    local_16c = local_170;
    local_174 = local_174 + 1;
    local_170 = K_1928._8_4_ + iVar3 + auStack344[lVar2];
  }
  local_174 = 0x3c;
  while (local_174 < 0x50) {
    iVar3 = (local_170 << 5 | local_170 >> 0x1b) + (local_16c ^ local_168 ^ local_164) + local_160;
    lVar2 = (long)local_174;
    local_160 = local_164;
    local_164 = local_168;
    local_168 = local_16c >> 2 | local_16c << 0x1e;
    local_16c = local_170;
    local_174 = local_174 + 1;
    local_170 = K_1928._12_4_ + iVar3 + auStack344[lVar2];
  }
  *param_1 = *param_1 + local_170;
  param_1[1] = param_1[1] + local_16c;
  param_1[2] = param_1[2] + local_168;
  param_1[3] = param_1[3] + local_164;
  param_1[4] = param_1[4] + local_160;
  *(undefined2 *)(param_1 + 7) = 0;
  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return;
}


void HASHPadMessage(long param_1)

{
  short sVar1;
  
  if (*(short *)(param_1 + 0x1c) < 0x38) {
    sVar1 = *(short *)(param_1 + 0x1c);
    *(short *)(param_1 + 0x1c) = sVar1 + 1;
    *(undefined *)(param_1 + 0x1e + (long)(int)sVar1) = 0x80;
    while (*(short *)(param_1 + 0x1c) < 0x38) {
      sVar1 = *(short *)(param_1 + 0x1c);
      *(short *)(param_1 + 0x1c) = sVar1 + 1;
      *(undefined *)(param_1 + 0x1e + (long)(int)sVar1) = 0;
    }
  }
  else {
    sVar1 = *(short *)(param_1 + 0x1c);
    *(short *)(param_1 + 0x1c) = sVar1 + 1;
    *(undefined *)(param_1 + 0x1e + (long)(int)sVar1) = 0x80;
    while (*(short *)(param_1 + 0x1c) < 0x40) {
      sVar1 = *(short *)(param_1 + 0x1c);
      *(short *)(param_1 + 0x1c) = sVar1 + 1;
      *(undefined *)(param_1 + 0x1e + (long)(int)sVar1) = 0;
    }
    HASHProcessMessageBlock(param_1);
    while (*(short *)(param_1 + 0x1c) < 0x38) {
      sVar1 = *(short *)(param_1 + 0x1c);
      *(short *)(param_1 + 0x1c) = sVar1 + 1;
      *(undefined *)(param_1 + 0x1e + (long)(int)sVar1) = 0;
    }
  }
  *(char *)(param_1 + 0x56) = (char)((uint)*(undefined4 *)(param_1 + 0x18) >> 0x18);
  *(char *)(param_1 + 0x57) = (char)((uint)*(undefined4 *)(param_1 + 0x18) >> 0x10);
  *(char *)(param_1 + 0x58) = (char)((uint)*(undefined4 *)(param_1 + 0x18) >> 8);
  *(char *)(param_1 + 0x59) = (char)*(undefined4 *)(param_1 + 0x18);
  *(char *)(param_1 + 0x5a) = (char)((uint)*(undefined4 *)(param_1 + 0x14) >> 0x18);
  *(char *)(param_1 + 0x5b) = (char)((uint)*(undefined4 *)(param_1 + 0x14) >> 0x10);
  *(char *)(param_1 + 0x5c) = (char)((uint)*(undefined4 *)(param_1 + 0x14) >> 8);
  *(char *)(param_1 + 0x5d) = (char)*(undefined4 *)(param_1 + 0x14);
  HASHProcessMessageBlock(param_1);
  return;
}


undefined8 main(int param_1,char **param_2)

{
  int iVar1;
  int __fd;
  size_t sVar2;
  long in_FS_OFFSET;
  int local_5d4;
  int local_5d0;
  undefined local_5b8 [112];
  undefined local_548 [192];
  char local_488 [16];
  undefined local_478;
  undefined local_477;
  undefined local_476;
  undefined local_475;
  undefined local_474;
  undefined local_473;
  undefined local_472;
  undefined local_471;
  undefined local_470;
  undefined local_46f;
  undefined local_46e;
  undefined local_46d;
  undefined local_46c;
  undefined local_46b;
  undefined local_46a;
  undefined local_469;
  char local_468 [32];
  char local_448 [64];
  char local_408 [1000];
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  local_478 = 0x15;
  local_477 = 0x9f;
  local_476 = 0x31;
  local_475 = 0x16;
  local_474 = 0xbf;
  local_473 = 0xde;
  local_472 = 0xb;
  local_471 = 0x14;
  local_470 = 0x70;
  local_46f = 0x34;
  local_46e = 0x8e;
  local_46d = 0x6e;
  local_46c = 0x32;
  local_46b = 0xc3;
  local_46a = 0xb9;
  local_469 = 0xe0;
LAB_001027cd:
  do {
    iVar1 = getopt(param_1,param_2,"hed:");
    if (iVar1 == -1) {
      iVar1 = open(param_2[3],0);
      __fd = open(param_2[4],0x41,0x1c0);
      read(iVar1,local_408,1000);
      HASHReset(local_5b8);
      sVar2 = strlen(param_2[2]);
      HASHInput(local_5b8,param_2[2],sVar2 & 0xffffffff,param_2[2]);
      HASHResult(local_5b8,local_468,local_468);
      strncpy(local_488,local_468,0x10);
      iVar1 = strncmp("kimjongun_supremeleader",param_2[2],0x17);
      if (iVar1 == 0) {
        puts("success");
        local_5d4 = 0;
        while (sVar2 = strlen(local_408), (ulong)(long)local_5d4 < sVar2) {
          local_448[local_5d4] = local_408[local_5d4];
          local_5d4 = local_5d4 + 1;
        }
        AES_init_ctx_iv(local_548,local_488,iv,local_488);
        if (local_5d0 == 0) {
          AES_CBC_encrypt_buffer(local_548,local_448,0x10,local_448);
        }
        else {
          if (local_5d0 == 1) {
            AES_CBC_decrypt_buffer(local_548,local_448,0x10,local_448);
          }
        }
        local_5d4 = 0;
        while (sVar2 = strlen(local_448), (ulong)(long)local_5d4 < sVar2) {
          local_408[local_5d4] = local_448[local_5d4];
          local_5d4 = local_5d4 + 1;
        }
        sVar2 = strlen(local_408);
        write(__fd,local_408,sVar2);
      }
      else {
        puts("wrong password. good-bye");
      }
LAB_00102a73:
      if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
        return 0;
      }
                    /* WARNING: Subroutine does not return */
      __stack_chk_fail();
    }
    if (iVar1 == 0x65) {
      local_5d0 = 0;
      goto LAB_001027cd;
    }
    if (iVar1 == 0x68) {
      puts("Usage: exe (-e or -d) passphrase inputfile outputfile");
      goto LAB_00102a73;
    }
    if (iVar1 == 100) {
      local_5d0 = 1;
    }
  } while( true );
}


void __libc_csu_init(EVP_PKEY_CTX *param_1,undefined8 param_2,undefined8 param_3)

{
  long lVar1;
  
  _init(param_1);
  lVar1 = 0;
  do {
    (*(code *)(&__frame_dummy_init_array_entry)[lVar1])((ulong)param_1 & 0xffffffff,param_2,param_3)
    ;
    lVar1 = lVar1 + 1;
  } while (lVar1 != 1);
  return;
}


void __libc_csu_fini(void)

{
  return;
}


void _fini(void)

{
  return;
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

char * strncpy(char *__dest,char *__src,size_t __n)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strncpy@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

int strncmp(char *__s1,char *__s2,size_t __n)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strncmp@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */

void _ITM_deregisterTMCloneTable(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

int puts(char *__s)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* puts@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

ssize_t write(int __fd,void *__buf,size_t __n)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* write@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

size_t strlen(char *__s)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strlen@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */

void __stack_chk_fail(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* __stack_chk_fail@@GLIBC_2.4 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

ssize_t read(int __fd,void *__buf,size_t __nbytes)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* read@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */

void __libc_start_main(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* __libc_start_main@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */

void __gmon_start__(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

int open(char *__file,int __oflag,...)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* open@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

int getopt(int ___argc,char **___argv,char *__shortopts)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* getopt@@GLIBC_2.2.5 */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */

void _ITM_registerTMCloneTable(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


/* WARNING: Control flow encountered bad instruction data */

void __cxa_finalize(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* __cxa_finalize@@GLIBC_2.2.5 */
  halt_baddata();
}

