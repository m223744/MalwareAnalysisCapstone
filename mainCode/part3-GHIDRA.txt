-----GHIDRA ANALYSIS REPORT-----File Processed: part3----------------------Functions Decompiled: -----FUNCTION NAME: __libc_csu_init
void __libc_csu_init(EVP_PKEY_CTX *param_1,undefined8 param_2,undefined8 param_3)

{
  long lVar1;
  
  _init(param_1);
  lVar1 = 0;
  do {
    (*(code *)(&__frame_dummy_init_array_entry)[lVar1])((ulong)param_1 & 0xffffffff,param_2,param_3)
    ;
    lVar1 = lVar1 + 1;
  } while (lVar1 != 1);
  return;
}

-----FUNCTION NAME: _init
int _init(EVP_PKEY_CTX *ctx)

{
  undefined *puVar1;
  
  puVar1 = PTR___gmon_start___00300fe8;
  if (PTR___gmon_start___00300fe8 != (undefined *)0x0) {
    puVar1 = (undefined *)(*(code *)PTR___gmon_start___00300fe8)();
  }
  return (int)puVar1;
}

-----FUNCTION NAME: _start
void _start(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  undefined8 in_stack_00000000;
  undefined auStack8 [8];
  
  (*(code *)PTR___libc_start_main_00300fe0)
            (main,in_stack_00000000,&stack0x00000008,__libc_csu_init,__libc_csu_fini,param_3,
             auStack8);
  do {
                    /* WARNING: Do nothing block with infinite loop */
  } while( true );
}

-----FUNCTION NAME: __stack_chk_fail
/* WARNING: Control flow encountered bad instruction data */

void __stack_chk_fail(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* __stack_chk_fail@@GLIBC_2.4 */
  halt_baddata();
}

-----FUNCTION NAME: main
undefined8 main(void)

{
  int iVar1;
  long in_FS_OFFSET;
  char local_38 [16];
  char local_28 [24];
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  func1(local_38);
  func2(local_28);
  iVar1 = strcmp(local_38,local_28);
  if (iVar1 == 0) {
    puts("Usernames and passwords cannot be the same. Please enter a new initial password.");
  }
  else {
    iVar1 = func3(local_28);
    if (iVar1 == 0) {
      puts("Your passwords matched. Congratulations!");
    }
    else {
      puts("Your passwords did not match. Try again.");
    }
  }
  if (local_10 == *(long *)(in_FS_OFFSET + 0x28)) {
    return 0;
  }
                    /* WARNING: Subroutine does not return */
  __stack_chk_fail();
}

-----FUNCTION NAME: printf
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

int printf(char *__format,...)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* printf@@GLIBC_2.2.5 */
  halt_baddata();
}

-----FUNCTION NAME: deregister_tm_clones
/* WARNING: Removing unreachable block (ram,0x001006e7) */
/* WARNING: Removing unreachable block (ram,0x001006f3) */

void deregister_tm_clones(void)

{
  return;
}

-----FUNCTION NAME: __isoc99_scanf
/* WARNING: Control flow encountered bad instruction data */

void __isoc99_scanf(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* __isoc99_scanf@@GLIBC_2.7 */
  halt_baddata();
}

-----FUNCTION NAME: __libc_start_main
/* WARNING: Control flow encountered bad instruction data */

void __libc_start_main(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* __libc_start_main@@GLIBC_2.2.5 */
  halt_baddata();
}

-----FUNCTION NAME: _ITM_deregisterTMCloneTable
/* WARNING: Control flow encountered bad instruction data */

void _ITM_deregisterTMCloneTable(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}

-----FUNCTION NAME: frame_dummy
void frame_dummy(void)

{
  register_tm_clones();
  return;
}

-----FUNCTION NAME: _ITM_registerTMCloneTable
/* WARNING: Control flow encountered bad instruction data */

void _ITM_registerTMCloneTable(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}

-----FUNCTION NAME: strcmp
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

int strcmp(char *__s1,char *__s2)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strcmp@@GLIBC_2.2.5 */
  halt_baddata();
}

-----FUNCTION NAME: __cxa_finalize
/* WARNING: Control flow encountered bad instruction data */

void __cxa_finalize(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* __cxa_finalize@@GLIBC_2.2.5 */
  halt_baddata();
}

-----FUNCTION NAME: register_tm_clones
/* WARNING: Removing unreachable block (ram,0x00100738) */
/* WARNING: Removing unreachable block (ram,0x00100744) */

void register_tm_clones(void)

{
  return;
}

-----FUNCTION NAME: FUN_00100630
void FUN_00100630(void)

{
                    /* WARNING: Treating indirect jump as call */
  (*(code *)PTR_00300fa8)();
  return;
}

-----FUNCTION NAME: __gmon_start__
/* WARNING: Control flow encountered bad instruction data */

void __gmon_start__(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}

-----FUNCTION NAME: puts
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention yet parameter storage is locked */

int puts(char *__s)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* puts@@GLIBC_2.2.5 */
  halt_baddata();
}

-----FUNCTION NAME: __libc_csu_fini
void __libc_csu_fini(void)

{
  return;
}

-----FUNCTION NAME: __do_global_dtors_aux
void __do_global_dtors_aux(void)

{
  if (completed_7698 == '\0') {
    if (PTR___cxa_finalize_00300ff8 != (undefined *)0x0) {
      __cxa_finalize(__dso_handle);
    }
    deregister_tm_clones();
    completed_7698 = 1;
    return;
  }
  return;
}

-----FUNCTION NAME: _fini
void _fini(void)

{
  return;
}

-----FUNCTION NAME: func1
undefined8 func1(undefined8 param_1)

{
  printf("Please enter your username: ");
  __isoc99_scanf(&DAT_00100aa6,param_1);
  return 0;
}

-----FUNCTION NAME: func2
undefined8 func2(undefined8 param_1)

{
  printf("Please enter your initial password: ");
  __isoc99_scanf(&DAT_00100aa6,param_1);
  return 0;
}

-----FUNCTION NAME: func3
bool func3(char *param_1)

{
  int iVar1;
  long in_FS_OFFSET;
  char local_28 [24];
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  printf("Please re-enter your password: ");
  __isoc99_scanf(&DAT_00100aa6,local_28);
  iVar1 = strcmp(local_28,param_1);
  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return iVar1 != 0;
}

